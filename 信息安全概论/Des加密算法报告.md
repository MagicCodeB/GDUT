# Des加密算法报告

​	**Des算法原理：DES算法为密码体制中的对称密码体制，又被称为美国数据加密标准。DES是一个分组加密算法，典型的DES以64位为分组对数据加密，加密和解密用的是同一个算法。密钥长64位，密钥事实上是56位参与DES运算（第8、16、24、32、40、48、56、64位是校验位，使得每个密钥都有奇数个1），分组后的明文组和56位的密钥按位替代或交换的方法形成密文组**

## 1.IP置换

将输入的64位数据块按块进行重新组合，并把输出分为L0,R0两部分，各长32位

## 2.密钥置换

将DES的密钥由64位减至56位，每个字节的第8位作为奇偶校验位在DES的每一轮中，从56位密钥产生出不同的48位子密钥，确定这些子密钥的方式如下：将56位的密钥分成两部分，每部分28位，根据轮数，这两部分分别循环左移1位或2位。移动后，从56位中选出48位。这个过程中，既置换了每位的顺序，又选择了子密钥

## 3.E拓展置换

扩展置置换目标是IP置换后获得的右半部分R0，将32位输入扩展为48位(分为4位×8组)输出。扩展置换目的有两个：生成与密钥相同长度的数据以进行异或运算；提供更长的结果，在后续的替代运算中可以进行压缩

## 4.S盒代替

压缩后的密钥与扩展分组异或以后得到48位的数据，将这个数据送人S盒，进行替代运算。替代由8个不同的S盒完成，每个S盒有6位输入4位输出。48位输入分为8个6位的分组，一个分组对应一个S盒，对应的S盒对各组进行代替操作。

## 5.P盒置换

S盒代替运算的32位输出按照P盒进行置换。该置换把输入的每位映射到输出位，任何一位不能被映射两次，也不能被略去

## 6.IP-1末置换

末置换是初始置换的逆过程，DES最后一轮后，左、右两半部分并未进行交换，而是两部分合并形成一个分组做为末置换的输入

## 程序结果

默认明文和默认密钥均为：1111111111111111

统计在密钥和明文固定情况下改变输入明文/密钥的位数，计算平均密文位数改变情况

**改变明文的情况下：**

改变明文位数为1时，平均密文改变位数为31.8
改变明文位数为2时，平均密文改变位数为32.0
改变明文位数为3时，平均密文改变位数为30.95
改变明文位数为4时，平均密文改变位数为32.95
改变明文位数为5时，平均密文改变位数为30.85
改变明文位数为6时，平均密文改变位数为32.9
改变明文位数为7时，平均密文改变位数为32.5
改变明文位数为8时，平均密文改变位数为31.95
改变明文位数为9时，平均密文改变位数为31.7
改变明文位数为10时，平均密文改变位数为31.7
改变明文位数为11时，平均密文改变位数为32.3
改变明文位数为12时，平均密文改变位数为31.95
改变明文位数为13时，平均密文改变位数为32.55
改变明文位数为14时，平均密文改变位数为31.5
改变明文位数为15时，平均密文改变位数为32.8
改变明文位数为16时，平均密文改变位数为32.8
改变明文位数为17时，平均密文改变位数为31.85
改变明文位数为18时，平均密文改变位数为32.95
改变明文位数为19时，平均密文改变位数为32.4
改变明文位数为20时，平均密文改变位数为33.35
改变明文位数为21时，平均密文改变位数为30.4
改变明文位数为22时，平均密文改变位数为31.85
改变明文位数为23时，平均密文改变位数为31.65
改变明文位数为24时，平均密文改变位数为31.85
改变明文位数为25时，平均密文改变位数为31.3
改变明文位数为26时，平均密文改变位数为32.15
改变明文位数为27时，平均密文改变位数为31.75
改变明文位数为28时，平均密文改变位数为32.05
改变明文位数为29时，平均密文改变位数为31.4
改变明文位数为30时，平均密文改变位数为31.55
改变明文位数为31时，平均密文改变位数为30.6
改变明文位数为32时，平均密文改变位数为32.0
改变明文位数为33时，平均密文改变位数为31.3
改变明文位数为34时，平均密文改变位数为31.4
改变明文位数为35时，平均密文改变位数为32.9
改变明文位数为36时，平均密文改变位数为31.7
改变明文位数为37时，平均密文改变位数为33.65
改变明文位数为38时，平均密文改变位数为32.6
改变明文位数为39时，平均密文改变位数为32.55
改变明文位数为40时，平均密文改变位数为31.9
改变明文位数为41时，平均密文改变位数为32.45
改变明文位数为42时，平均密文改变位数为31.25
改变明文位数为43时，平均密文改变位数为30.0
改变明文位数为44时，平均密文改变位数为32.6
改变明文位数为45时，平均密文改变位数为31.95
改变明文位数为46时，平均密文改变位数为32.25
改变明文位数为47时，平均密文改变位数为30.4
改变明文位数为48时，平均密文改变位数为31.65
改变明文位数为49时，平均密文改变位数为31.45
改变明文位数为50时，平均密文改变位数为32.95
改变明文位数为51时，平均密文改变位数为31.4
改变明文位数为52时，平均密文改变位数为31.4
改变明文位数为53时，平均密文改变位数为32.8
改变明文位数为54时，平均密文改变位数为32.7
改变明文位数为55时，平均密文改变位数为31.1
改变明文位数为56时，平均密文改变位数为30.4
改变明文位数为57时，平均密文改变位数为31.35
改变明文位数为58时，平均密文改变位数为30.85
改变明文位数为59时，平均密文改变位数为31.05
改变明文位数为60时，平均密文改变位数为33.75
改变明文位数为61时，平均密文改变位数为34.2
改变明文位数为62时，平均密文改变位数为31.65
改变明文位数为63时，平均密文改变位数为33.05
改变明文位数为64时，平均密文改变位数为33.0

**改变密钥的情况下：**

改变密钥位数为1时，平均密文改变位数为26.2
改变密钥位数为2时，平均密文改变位数为32.3
改变密钥位数为3时，平均密文改变位数为32.7
改变密钥位数为4时，平均密文改变位数为33.9
改变密钥位数为5时，平均密文改变位数为30.8
改变密钥位数为6时，平均密文改变位数为32.5
改变密钥位数为7时，平均密文改变位数为32.4
改变密钥位数为8时，平均密文改变位数为32.6
改变密钥位数为9时，平均密文改变位数为32.5
改变密钥位数为10时，平均密文改变位数为31.4
改变密钥位数为11时，平均密文改变位数为32.8
改变密钥位数为12时，平均密文改变位数为32.65
改变密钥位数为13时，平均密文改变位数为32.9
改变密钥位数为14时，平均密文改变位数为33.05
改变密钥位数为15时，平均密文改变位数为32.6
改变密钥位数为16时，平均密文改变位数为31.5
改变密钥位数为17时，平均密文改变位数为31.95
改变密钥位数为18时，平均密文改变位数为30.55
改变密钥位数为19时，平均密文改变位数为32.5
改变密钥位数为20时，平均密文改变位数为32.45
改变密钥位数为21时，平均密文改变位数为30.85
改变密钥位数为22时，平均密文改变位数为30.95
改变密钥位数为23时，平均密文改变位数为32.15
改变密钥位数为24时，平均密文改变位数为31.35
改变密钥位数为25时，平均密文改变位数为32.75
改变密钥位数为26时，平均密文改变位数为31.6
改变密钥位数为27时，平均密文改变位数为32.15
改变密钥位数为28时，平均密文改变位数为31.4
改变密钥位数为29时，平均密文改变位数为32.4
改变密钥位数为30时，平均密文改变位数为32.75
改变密钥位数为31时，平均密文改变位数为31.7
改变密钥位数为32时，平均密文改变位数为33.6
改变密钥位数为33时，平均密文改变位数为30.4
改变密钥位数为34时，平均密文改变位数为32.4
改变密钥位数为35时，平均密文改变位数为31.9
改变密钥位数为36时，平均密文改变位数为31.85
改变密钥位数为37时，平均密文改变位数为31.25
改变密钥位数为38时，平均密文改变位数为32.75
改变密钥位数为39时，平均密文改变位数为33.45
改变密钥位数为40时，平均密文改变位数为31.9
改变密钥位数为41时，平均密文改变位数为32.25
改变密钥位数为42时，平均密文改变位数为32.85
改变密钥位数为43时，平均密文改变位数为31.35
改变密钥位数为44时，平均密文改变位数为33.55
改变密钥位数为45时，平均密文改变位数为31.6
改变密钥位数为46时，平均密文改变位数为33.15
改变密钥位数为47时，平均密文改变位数为32.4
改变密钥位数为48时，平均密文改变位数为31.85
改变密钥位数为49时，平均密文改变位数为31.4
改变密钥位数为50时，平均密文改变位数为31.85
改变密钥位数为51时，平均密文改变位数为31.65
改变密钥位数为52时，平均密文改变位数为30.4
改变密钥位数为53时，平均密文改变位数为31.25
改变密钥位数为54时，平均密文改变位数为32.5
改变密钥位数为55时，平均密文改变位数为31.65
改变密钥位数为56时，平均密文改变位数为31.45
改变密钥位数为57时，平均密文改变位数为32.0
改变密钥位数为58时，平均密文改变位数为32.35
改变密钥位数为59时，平均密文改变位数为30.05
改变密钥位数为60时，平均密文改变位数为32.35
改变密钥位数为61时，平均密文改变位数为32.05
改变密钥位数为62时，平均密文改变位数为32.5
改变密钥位数为63时，平均密文改变位数为33.0
改变密钥位数为64时，平均密文改变位数为31.0

## 程序实现

```java
BitsArray(int length)
    {
        StringBuffer sb = new StringBuffer();
        for(int i = 0; i < length; i++) sb.append("0");
        str = sb.toString();
    }

BitsArray(byte[] bs)
{
    fromByteArray(bs);
}

int length()
{
    return str.length();
}

void fromByteArray(byte[] bs)
{
    StringBuffer result = new StringBuffer();
    for (int i = 0; i < bs.length; i++)
    {
        int length = Long.toString(bs[i] & 0xff, 2).length();
        String str = "";
        if(length < 8)
        {
            StringBuffer sb = new StringBuffer();
            for(int j = 0; j < 8 - length; j++) sb.append("0");
            str = sb.toString();
         }
         result.append(str + Long.toString(bs[i] & 0xff, 2));
     }
     str =  result.toString();
}

byte[] toByteArray()
{
    String[] temp = new String[8];
    int pos = 0;
    for(int i = 0; i < 8; i++)
    {
        temp[i] = str.substring(pos, pos + 8);
        pos += 8;
    }
    byte[] b = new byte[8];
    for (int i = 0; i < b.length; i++) b[i] = Long.valueOf(temp[i], 2).byteValue();
    return b;
}

void xor(BitsArray other)
{
    String otherStr = other.toString();
    char[] cs = str.toCharArray();
    for(int i = 0; i < otherStr.length(); i++)
    {
        if(str.charAt(i) == otherStr.charAt(i)) cs[i] = '0';
        else cs[i] = '1';
     }
     str = Arrays.toString(cs).replaceAll("[\\[\\]\\s,]", "");
}

int OnesCount()
{
    int count = 0;
    for(int i = 0; i < str.length(); i++) if(str.charAt(i) == '1') count++
    return count;
}

@Override
protected BitsArray clone()
{
    byte[] bs = toByteArray();
    BitsArray bitsArray = new BitsArray(bs)
    return bitsArray;
}
    
void setOne(int index)
{
    char[] cs = str.toCharArray();
    cs[index] = '1';
    str = Arrays.toString(cs).replaceAll("[\\[\\]\\s,]", "");
}

void setZero(int index)
{
    char[] cs = str.toCharArray();
    cs[index] = '0';
    str = Arrays.toString(cs).replaceAll("[\\[\\]\\s,]", "");
}
    
void set(int index, int value)
{
     char[] cs = str.toCharArray();
     cs[index] = (char) ('0' + value);
     str = Arrays.toString(cs).replaceAll("[\\[\\]\\s,]", "");
}

@Override
public String toString()
{
    return str.toString();
}
```

